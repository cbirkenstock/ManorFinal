import { API, DataStore, graphqlOperation } from "aws-amplify";
import { Message, Reaction } from "../src/models";
import { PendingAnnouncement } from "../src/models";
import { ChatUser } from "../src/models";
import * as queries from "../src/graphql/queries";

const pendingAnnouncements = async () => {
  try {
    const { nextToken, items } = (
      (await API.graphql(
        graphqlOperation(queries.listChatUsers, {
          limit: 10000,
        })
      )) as any
    ).data.listChatUsers;

    return items.filter((item) => item.nickname === "John Smith");
  } catch (error) {
    console.log(JSON.stringify(error));
  }
};

const useDataClean = async () => {
  const a = await pendingAnnouncements();
  const b = await DataStore.query(ChatUser, (chatUser) =>
    chatUser.nickname("eq", "John Smith")
  );

  console.log(a[0].unreadMessagesCount);
  console.log(b[0].unreadMessagesCount);

  // for (const pendingAnnouncement of pendingAnnouncements) {
  //   console.log("hey");
  //   if (!pendingAnnouncement.chatUser || !pendingAnnouncement.message) {
  //     console.log(pendingAnnouncement.chatUser, pendingAnnouncement.message);
  //   }
  // }

  // const reactions = await DataStore.query(Reaction);

  // for (const reaction of reactions) {
  //   if (!reaction.chatUser || !reaction.message) {
  //     console.log(reaction.chatUser, reaction.message);
  //   }
  // }
};

export default useDataClean;

const a = {
  data: {
    listPendingAnnouncements: {
      items: [
        {
          id: "0a0e8332-93c2-4827-82e2-22e1feba45ef",
          chatUserID: "5f1666bb-e5f8-4976-b48f-448e13c4fb7c",
          messageID: "40f65273-89a5-42b9-bc33-04a6df746fb9",
          chatUser: {
            id: "5f1666bb-e5f8-4976-b48f-448e13c4fb7c",
            userID: "4363c9dd-13d4-48ae-bf27-fc305d53565a",
            chatID: "650ee441-7358-454f-832d-be3cf8b35b3b",
            isOfActiveChat: true,
            notificationsEnabled: true,
            nickname: "Colin Birkenstock",
            hasUnreadMessage: false,
            hasUnreadAnnouncement: false,
            unreadMessagesCount: 0,
            isAdmin: false,
            profileImageUrl:
              "e6f8374a-27b8-40a7-819c-bc232c1f449d-reducedSizeVersion.jpg",
            createdAt: "2022-09-08T00:07:45.912Z",
            updatedAt: "2022-09-08T00:14:53.484Z",
            _version: 7,
            _deleted: null,
            _lastChangedAt: 1662596093525,
          },
          message: {
            id: "40f65273-89a5-42b9-bc33-04a6df746fb9",
            marginTop: null,
            timeCardDateTime: null,
            isEventMessage: null,
            eventChatID: null,
            eventTitle: null,
            eventDateTime: null,
            eventDescription: null,
            eventLocation: null,
            eventCapacity: null,
            eventMembersCount: null,
            suggestionStatus: null,
            messageBody: null,
            isAnnouncementMessage: true,
            announcementBody: "Whatâ€™s up ",
            imageUrl: null,
            chatID: "650ee441-7358-454f-832d-be3cf8b35b3b",
            chatuserID: "25710a16-f571-40a0-958b-d5ec6a68d04d",
            likes: null,
            dislikes: null,
            link: null,
            isMandatory: false,
            imageHeight: null,
            imageWidth: null,
            isAccepted: null,
            dateSuggestion: null,
            remindDate: null,
            replyToMessageID: null,
            replyToMessageSenderName: null,
            replyToMessageBody: null,
            replyToMessageImageUrl: null,
            urlPreviewImageUrl: null,
            urlPreviewTitle: null,
            urlPreviewWebsiteUrl: null,
            createdAt: "2022-09-08T00:07:53.471Z",
            updatedAt: "2022-09-08T00:07:53.471Z",
            _version: 1,
            _deleted: null,
            _lastChangedAt: 1662595673495,
          },
          remindDate: null,
          createdAt: "2022-09-08T00:07:53.823Z",
          updatedAt: "2022-09-08T00:07:53.823Z",
          _version: 2,
          _deleted: true,
          _lastChangedAt: 1662596466413,
        },
        {
          id: "aacea2f7-554e-4737-a093-455573c3f320",
          chatUserID: "83c8eb5f-6ab6-4c39-8f26-d01a9bd0090c",
          messageID: "b94e0d14-d8e6-4006-b96e-908e8777843f",
          chatUser: {
            id: "83c8eb5f-6ab6-4c39-8f26-d01a9bd0090c",
            userID: "4363c9dd-13d4-48ae-bf27-fc305d53565a",
            chatID: "2088f60b-5932-4e18-aa88-1afc859bd4be",
            isOfActiveChat: true,
            notificationsEnabled: true,
            nickname: "Colin Birkenstock",
            hasUnreadMessage: false,
            hasUnreadAnnouncement: false,
            unreadMessagesCount: 0,
            isAdmin: true,
            profileImageUrl:
              "d1302e0b-0549-4234-8b70-b0a0dbbd7614-reducedSizeVersion.jpg",
            createdAt: "2022-09-05T17:55:01.925Z",
            updatedAt: "2022-09-06T23:51:13.762Z",
            _version: 59,
            _deleted: null,
            _lastChangedAt: 1662508273801,
          },
          message: {
            id: "b94e0d14-d8e6-4006-b96e-908e8777843f",
            marginTop: null,
            timeCardDateTime: null,
            isEventMessage: null,
            eventChatID: null,
            eventTitle: null,
            eventDateTime: null,
            eventDescription: null,
            eventLocation: null,
            eventCapacity: null,
            eventMembersCount: null,
            suggestionStatus: null,
            messageBody: null,
            isAnnouncementMessage: true,
            announcementBody: "Yo!",
            imageUrl: null,
            chatID: "2088f60b-5932-4e18-aa88-1afc859bd4be",
            chatuserID: "982cccaa-061f-46ae-a8d6-bc57ec85f333",
            likes: null,
            dislikes: null,
            link: null,
            isMandatory: false,
            imageHeight: null,
            imageWidth: null,
            isAccepted: null,
            dateSuggestion: null,
            remindDate: null,
            replyToMessageID: null,
            replyToMessageSenderName: null,
            replyToMessageBody: null,
            replyToMessageImageUrl: null,
            urlPreviewImageUrl: null,
            urlPreviewTitle: null,
            urlPreviewWebsiteUrl: null,
            createdAt: "2022-09-05T22:28:26.780Z",
            updatedAt: "2022-09-05T22:28:26.780Z",
            _version: 1,
            _deleted: null,
            _lastChangedAt: 1662416906801,
          },
          remindDate: null,
          createdAt: "2022-09-05T22:28:26.955Z",
          updatedAt: "2022-09-05T22:28:26.955Z",
          _version: 2,
          _deleted: true,
          _lastChangedAt: 1662417182975,
        },
        null,
        {
          id: "b431179b-d4e0-4973-934d-b1bd95d00c39",
          chatUserID: "bbbad20f-b53c-4a3b-900d-22cd4479c6ee",
          messageID: "715d2511-be2c-4cfe-b26f-7f37222f85d9",
          chatUser: {
            id: "bbbad20f-b53c-4a3b-900d-22cd4479c6ee",
            userID: "50a07372-e259-409b-a7f2-40362b40382b",
            chatID: "a7b14eb2-a55f-4a94-8a08-bc58440c6cb0",
            isOfActiveChat: true,
            notificationsEnabled: true,
            nickname: "John Smith",
            hasUnreadMessage: false,
            hasUnreadAnnouncement: false,
            unreadMessagesCount: 0,
            isAdmin: false,
            profileImageUrl:
              "b4c0550a-4a61-4f15-b21d-6bc9de85a799-reducedSizeVersion.jpg",
            createdAt: "2022-09-05T18:32:04.531Z",
            updatedAt: "2022-09-06T22:05:11.578Z",
            _version: 13,
            _deleted: null,
            _lastChangedAt: 1662501911627,
          },
          message: {
            id: "715d2511-be2c-4cfe-b26f-7f37222f85d9",
            marginTop: null,
            timeCardDateTime: null,
            isEventMessage: null,
            eventChatID: null,
            eventTitle: null,
            eventDateTime: null,
            eventDescription: null,
            eventLocation: null,
            eventCapacity: null,
            eventMembersCount: null,
            suggestionStatus: null,
            messageBody: null,
            isAnnouncementMessage: true,
            announcementBody: "Yo",
            imageUrl: null,
            chatID: "a7b14eb2-a55f-4a94-8a08-bc58440c6cb0",
            chatuserID: "e4137a69-7108-43da-a238-a8431d7602a0",
            likes: null,
            dislikes: null,
            link: null,
            isMandatory: false,
            imageHeight: null,
            imageWidth: null,
            isAccepted: null,
            dateSuggestion: null,
            remindDate: null,
            replyToMessageID: null,
            replyToMessageSenderName: null,
            replyToMessageBody: null,
            replyToMessageImageUrl: null,
            urlPreviewImageUrl: null,
            urlPreviewTitle: null,
            urlPreviewWebsiteUrl: null,
            createdAt: "2022-09-06T07:40:44.811Z",
            updatedAt: "2022-09-06T07:40:44.811Z",
            _version: 1,
            _deleted: null,
            _lastChangedAt: 1662450044834,
          },
          remindDate: null,
          createdAt: "2022-09-06T07:40:44.973Z",
          updatedAt: "2022-09-06T07:40:44.973Z",
          _version: 2,
          _deleted: true,
          _lastChangedAt: 1662502229354,
        },
        {
          id: "d7fca368-d799-41d4-9427-dd2060c81992",
          chatUserID: "e4137a69-7108-43da-a238-a8431d7602a0",
          messageID: "ca33db4d-52e9-46f2-80a3-b98975870d01",
          chatUser: {
            id: "e4137a69-7108-43da-a238-a8431d7602a0",
            userID: "4363c9dd-13d4-48ae-bf27-fc305d53565a",
            chatID: "a7b14eb2-a55f-4a94-8a08-bc58440c6cb0",
            isOfActiveChat: true,
            notificationsEnabled: true,
            nickname: "Colin Birkenstock",
            hasUnreadMessage: false,
            hasUnreadAnnouncement: false,
            unreadMessagesCount: 0,
            isAdmin: true,
            profileImageUrl:
              "e6f8374a-27b8-40a7-819c-bc232c1f449d-reducedSizeVersion.jpg",
            createdAt: "2022-09-05T18:32:04.764Z",
            updatedAt: "2022-09-06T23:48:22.433Z",
            _version: 34,
            _deleted: null,
            _lastChangedAt: 1662508102451,
          },
          message: {
            id: "ca33db4d-52e9-46f2-80a3-b98975870d01",
            marginTop: null,
            timeCardDateTime: null,
            isEventMessage: null,
            eventChatID: null,
            eventTitle: null,
            eventDateTime: null,
            eventDescription: null,
            eventLocation: null,
            eventCapacity: null,
            eventMembersCount: null,
            suggestionStatus: null,
            messageBody: null,
            isAnnouncementMessage: true,
            announcementBody: "Hey",
            imageUrl: null,
            chatID: "a7b14eb2-a55f-4a94-8a08-bc58440c6cb0",
            chatuserID: "bbbad20f-b53c-4a3b-900d-22cd4479c6ee",
            likes: null,
            dislikes: null,
            link: null,
            isMandatory: false,
            imageHeight: null,
            imageWidth: null,
            isAccepted: null,
            dateSuggestion: null,
            remindDate: null,
            replyToMessageID: null,
            replyToMessageSenderName: null,
            replyToMessageBody: null,
            replyToMessageImageUrl: null,
            urlPreviewImageUrl: null,
            urlPreviewTitle: null,
            urlPreviewWebsiteUrl: null,
            createdAt: "2022-09-05T22:29:52.380Z",
            updatedAt: "2022-09-05T22:29:52.380Z",
            _version: 1,
            _deleted: null,
            _lastChangedAt: 1662416992412,
          },
          remindDate: null,
          createdAt: "2022-09-05T22:29:52.593Z",
          updatedAt: "2022-09-05T22:29:52.593Z",
          _version: 2,
          _deleted: true,
          _lastChangedAt: 1662418418140,
        },
        {
          id: "c8f416bc-43dd-4ceb-9742-238963f8b8fd",
          chatUserID: "6c263431-6054-42fe-949a-a8826369a456",
          messageID: "ceb0f02b-315b-4c31-8919-fd7a418157b1",
          chatUser: {
            id: "6c263431-6054-42fe-949a-a8826369a456",
            userID: "4363c9dd-13d4-48ae-bf27-fc305d53565a",
            chatID: "5d74b63f-4eaa-4377-8200-f405fc618b36",
            isOfActiveChat: true,
            notificationsEnabled: true,
            nickname: "Colin Birkenstock",
            hasUnreadMessage: true,
            hasUnreadAnnouncement: false,
            unreadMessagesCount: 0,
            isAdmin: false,
            profileImageUrl:
              "e6f8374a-27b8-40a7-819c-bc232c1f449d-reducedSizeVersion.jpg",
            createdAt: "2022-09-05T22:19:59.964Z",
            updatedAt: "2022-09-08T02:33:15.197Z",
            _version: 95,
            _deleted: null,
            _lastChangedAt: 1662604395248,
          },
          message: {
            id: "ceb0f02b-315b-4c31-8919-fd7a418157b1",
            marginTop: null,
            timeCardDateTime: null,
            isEventMessage: null,
            eventChatID: null,
            eventTitle: null,
            eventDateTime: null,
            eventDescription: null,
            eventLocation: null,
            eventCapacity: null,
            eventMembersCount: null,
            suggestionStatus: null,
            messageBody: null,
            isAnnouncementMessage: true,
            announcementBody: "Hi",
            imageUrl: null,
            chatID: "5d74b63f-4eaa-4377-8200-f405fc618b36",
            chatuserID: "9731bf42-dba0-45bb-8cc7-283d9baf189e",
            likes: null,
            dislikes: null,
            link: null,
            isMandatory: false,
            imageHeight: null,
            imageWidth: null,
            isAccepted: null,
            dateSuggestion: null,
            remindDate: null,
            replyToMessageID: null,
            replyToMessageSenderName: null,
            replyToMessageBody: null,
            replyToMessageImageUrl: null,
            urlPreviewImageUrl: null,
            urlPreviewTitle: null,
            urlPreviewWebsiteUrl: null,
            createdAt: "2022-09-05T22:26:47.281Z",
            updatedAt: "2022-09-05T22:26:47.281Z",
            _version: 1,
            _deleted: null,
            _lastChangedAt: 1662416807303,
          },
          remindDate: null,
          createdAt: "2022-09-05T22:26:47.495Z",
          updatedAt: "2022-09-05T22:26:47.495Z",
          _version: 2,
          _deleted: true,
          _lastChangedAt: 1662417512797,
        },
      ],
      nextToken: null,
      startedAt: null,
    },
  },
  errors: [
    {
      path: ["listPendingAnnouncements", "items", 2, "message"],
      locations: null,
      message:
        "Cannot return null for non-nullable type: 'Message' within parent 'PendingAnnouncement' (/listPendingAnnouncements/items[2]/message)",
    },
  ],
};
